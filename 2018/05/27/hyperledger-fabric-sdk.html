<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <!-- JQuery (used for bootstrap and jekyll search) -->
    <script src="/assets/js/jquery-3.2.1.min.js" ></script>
    
    <!-- Main JS (navbar.js and katex_init.js)-->
    <script defer=true src="/assets/js/main.min.js"></script>
    
    <!-- CSS -->
    <link rel="stylesheet" href="/assets/css/main.css">

    <link rel="stylesheet" href="/assets/css/mermaid.css">

    <!--Favicon-->
    <link rel="shortcut icon" href="/assets/favicon.ico" type="image/x-icon">

    <!-- Canonical -->
    <link rel="canonical" href="http://localhost:4000/2018/05/27/hyperledger-fabric-sdk.html">

    <!-- RSS -->
    <link rel="alternate" type="application/atom+xml" title="小白" href="http://localhost:4000///feed.xml"/>

    <!-- Font Awesome -->
    <!-- <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet"> -->
    <link rel="stylesheet" type="text/css" href="/assets/css/font-awesome.min.css">

    <!-- Google Fonts -->
    
    <link href="//fonts.googleapis.com/css?family=Source+Sans+Pro:400,700,700italic,400italic" rel="stylesheet" type="text/css"> 
    

    <!-- KaTeX 0.8.3 -->
    
    <!--<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/KaTeX/0.8.3/katex.min.css">
    <script src="//cdnjs.cloudflare.com/ajax/libs/KaTeX/0.8.3/katex.min.js"></script> -->
    <link rel="stylesheet" type="text/css" href="/assets/css/katex.min.css">
    <script src="/assets/js/katex.min.js">
    </script>
    

    <!-- Google Analytics -->
    
    <script>
        (function(i, s, o, g, r, a, m) {
            i['GoogleAnalyticsObject'] = r;
            i[r] = i[r] || function() {
                (i[r].q = i[r].q || []).push(arguments)
            }, i[r].l = 1 * new Date();
            a = s.createElement(o),
                m = s.getElementsByTagName(o)[0];
            a.async = 1;
            a.src = g;
            m.parentNode.insertBefore(a, m)
        })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');

        ga('create', 'UA-89143952-2', 'auto');
        ga('send', 'pageview');

    </script>
    

    <!-- Baidu Analytics -->
    
    <script>
        var _hmt = _hmt || [];
        (function() {
          var hm = document.createElement("script");
          hm.src = 'https://hm.baidu.com/hm.js?2a8326534823f90fa4eef816aea2ef08';
          var s = document.getElementsByTagName("script")[0]; 
          s.parentNode.insertBefore(hm, s);
        })();
    </script>        
    
    
    <!-- seo tags -->
    <!-- Begin Jekyll SEO tag v2.4.0 -->
<title>fabric - Node.js SDK | 小白成长史</title>
<meta name="generator" content="Jekyll v3.7.3" />
<meta property="og:title" content="fabric - Node.js SDK" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="这里使用官方示例。" />
<meta property="og:description" content="这里使用官方示例。" />
<link rel="canonical" href="http://localhost:4000/2018/05/27/hyperledger-fabric-sdk.html" />
<meta property="og:url" content="http://localhost:4000/2018/05/27/hyperledger-fabric-sdk.html" />
<meta property="og:site_name" content="小白成长史" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2018-05-27T00:00:00+08:00" />
<script type="application/ld+json">
{"description":"这里使用官方示例。","@type":"BlogPosting","url":"http://localhost:4000/2018/05/27/hyperledger-fabric-sdk.html","headline":"fabric - Node.js SDK","dateModified":"2018-05-27T00:00:00+08:00","datePublished":"2018-05-27T00:00:00+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/2018/05/27/hyperledger-fabric-sdk.html"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

    <!-- Manual seo tags -->
    <!--
    <title>fabric - Node.js SDK | 小白</title>
    <meta name="description" content="这里使用官方示例。">
    -->
</head>

  <body>
    <header class="site-header">
    
    <!-- Logo and title -->
	<div class="branding">
		<a href="/">
			<img class="avatar" src="/assets/img/photo.jpeg" alt=""/>
		</a>

		<h1 class="site-title">
			<a href="/">小白</a>
		</h1>
	</div>
    
    <!-- Toggle menu -->
    <nav class="clear">
    <a id="pull" class="toggle" href="#">
    <i class="fa fa-bars fa-lg"></i>
    </a>
    
    <!-- Menu -->
    <ul>
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
         
        
        
        
        <li class="separator">
            |
        </li>
        <li>
            <a class="clear" href="/search">
                <i class="fa fa-search" aria-hidden="true"></i>
            </a>
        </li>
        
        
        <li class="separator">
            |
        </li>
        <li>
            <a class="clear" href="/tags">
                <i class="fa fa-tags" aria-hidden="true"></i>
            </a>
        </li>
        
        
    </ul>
        
	</nav>
</header>

    <div class="content">
      <article >
  <header id="main" style="background-image: url('/')">
    <h1 id="fabric+-+Node.js+SDK" class="title">fabric - Node.js SDK</h1>
    <p class="meta">
    May 27, 2018
    
    </p>
  </header>
  <section class="post-content"><p>这里使用官方示例。</p>

<p>如果之前没有部署过环境，先按照<a href="/2018/05/13/hyperledger-fabric-1.html">fabric入门（一）安装</a>进行环境部署。</p>

<h1 id="安装">安装</h1>

<p>首先进入示例目录</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cd </span>fabric-samples/balance-transfer/
</code></pre></div></div>

<p>有两种方法可以运行示例：</p>

<h2 id="方法一推荐">方法一（推荐）</h2>

<p>1.通过docker启动网络</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker-compose <span class="nt">-f</span> artifacts/docker-compose.yaml up
</code></pre></div></div>

<p>2.安装<em>fabric-client</em>和<em>fabric-ca-client</em>的node模块</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>npm <span class="nb">install</span>
</code></pre></div></div>

<p>3.启动node</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">PORT</span><span class="o">=</span>4000 node app
</code></pre></div></div>

<h2 id="方法二">方法二</h2>

<p>直接执行<em>runApp.sh</em></p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cd </span>fabric-samples/balance-transfer
./runApp.sh
</code></pre></div></div>

<p>这个方法你必须安装<strong>jq</strong></p>

<h1 id="网络配置">网络配置</h1>

<p>由于我们是使用docker，所以我们需要修改项目的网络配置。</p>

<p>修改<em>network-config.yaml</em>，把里面的localhost修改为docker实际ip地址，这里我的IP为192.168.99.100</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">---</span>
<span class="c">#</span>
<span class="c"># The network connection profile provides client applications the information about the target</span>
<span class="c"># blockchain network that are necessary for the applications to interact with it. These are all</span>
<span class="c"># knowledge that must be acquired from out-of-band sources. This file provides such a source.</span>
<span class="c">#</span>
name: <span class="s2">"balance-transfer"</span>

<span class="c">#</span>
<span class="c"># Any properties with an "x-" prefix will be treated as application-specific, exactly like how naming</span>
<span class="c"># in HTTP headers or swagger properties work. The SDK will simply ignore these fields and leave</span>
<span class="c"># them for the applications to process. This is a mechanism for different components of an application</span>
<span class="c"># to exchange information that are not part of the standard schema described below. In particular,</span>
<span class="c"># the "x-type" property with the "hlfv1" value example below is used by Hyperledger Composer to</span>
<span class="c"># determine the type of Fabric networks (v0.6 vs. v1.0) it needs to work with.</span>
<span class="c">#</span>
x-type: <span class="s2">"hlfv1"</span>

<span class="c">#</span>
<span class="c"># Describe what the target network is/does.</span>
<span class="c">#</span>
description: <span class="s2">"Balance Transfer Network"</span>

<span class="c">#</span>
<span class="c"># Schema version of the content. Used by the SDK to apply the corresponding parsing rules.</span>
<span class="c">#</span>
version: <span class="s2">"1.0"</span>

<span class="c">#</span>
<span class="c"># The client section will be added on a per org basis see org1.yaml and org2.yaml</span>
<span class="c">#</span>
<span class="c">#client:</span>

<span class="c">#</span>
<span class="c"># [Optional]. But most apps would have this section so that channel objects can be constructed</span>
<span class="c"># based on the content below. If an app is creating channels, then it likely will not need this</span>
<span class="c"># section.</span>
<span class="c">#</span>
channels:
  <span class="c"># name of the channel</span>
  mychannel:
    <span class="c"># Required. list of orderers designated by the application to use for transactions on this</span>
    <span class="c"># channel. This list can be a result of access control ("org1" can only access "ordererA"), or</span>
    <span class="c"># operational decisions to share loads from applications among the orderers.  The values must</span>
    <span class="c"># be "names" of orgs defined under "organizations/peers"</span>
    orderers:
      - orderer.example.com

    <span class="c"># Required. list of peers from participating orgs</span>
    peers:
      peer0.org1.example.com:
        <span class="c"># [Optional]. will this peer be sent transaction proposals for endorsement? The peer must</span>
        <span class="c"># have the chaincode installed. The app can also use this property to decide which peers</span>
        <span class="c"># to send the chaincode install request. Default: true</span>
        endorsingPeer: <span class="nb">true</span>

        <span class="c"># [Optional]. will this peer be sent query proposals? The peer must have the chaincode</span>
        <span class="c"># installed. The app can also use this property to decide which peers to send the</span>
        <span class="c"># chaincode install request. Default: true</span>
        chaincodeQuery: <span class="nb">true</span>

        <span class="c"># [Optional]. will this peer be sent query proposals that do not require chaincodes, like</span>
        <span class="c"># queryBlock(), queryTransaction(), etc. Default: true</span>
        ledgerQuery: <span class="nb">true</span>

        <span class="c"># [Optional]. will this peer be the target of the SDK's listener registration? All peers can</span>
        <span class="c"># produce events but the app typically only needs to connect to one to listen to events.</span>
        <span class="c"># Default: true</span>
        eventSource: <span class="nb">true

      </span>peer1.org1.example.com:
        endorsingPeer: <span class="nb">false
        </span>chaincodeQuery: <span class="nb">true
        </span>ledgerQuery: <span class="nb">true
        </span>eventSource: <span class="nb">false

      </span>peer0.org2.example.com:
        endorsingPeer: <span class="nb">true
        </span>chaincodeQuery: <span class="nb">true
        </span>ledgerQuery: <span class="nb">true
        </span>eventSource: <span class="nb">true

      </span>peer1.org2.example.com:
        endorsingPeer: <span class="nb">false
        </span>chaincodeQuery: <span class="nb">true
        </span>ledgerQuery: <span class="nb">true
        </span>eventSource: <span class="nb">false</span>

    <span class="c"># [Optional]. what chaincodes are expected to exist on this channel? The application can use</span>
    <span class="c"># this information to validate that the target peers are in the expected state by comparing</span>
    <span class="c"># this list with the query results of getInstalledChaincodes() and getInstantiatedChaincodes()</span>
    chaincodes:
      <span class="c"># the format follows the "cannonical name" of chaincodes by fabric code</span>
      - mycc:v0

<span class="c">#</span>
<span class="c"># list of participating organizations in this network</span>
<span class="c">#</span>
organizations:
  Org1:
    mspid: Org1MSP

    peers:
      - peer0.org1.example.com
      - peer1.org1.example.com

    <span class="c"># [Optional]. Certificate Authorities issue certificates for identification purposes in a Fabric based</span>
    <span class="c"># network. Typically certificates provisioning is done in a separate process outside of the</span>
    <span class="c"># runtime network. Fabric-CA is a special certificate authority that provides a REST APIs for</span>
    <span class="c"># dynamic certificate management (enroll, revoke, re-enroll). The following section is only for</span>
    <span class="c"># Fabric-CA servers.</span>
    certificateAuthorities:
      - ca-org1

    <span class="c"># [Optional]. If the application is going to make requests that are reserved to organization</span>
    <span class="c"># administrators, including creating/updating channels, installing/instantiating chaincodes, it</span>
    <span class="c"># must have access to the admin identity represented by the private key and signing certificate.</span>
    <span class="c"># Both properties can be the PEM string or local path to the PEM file. Note that this is mainly for</span>
    <span class="c"># convenience in development mode, production systems should not expose sensitive information</span>
    <span class="c"># this way. The SDK should allow applications to set the org admin identity via APIs, and only use</span>
    <span class="c"># this route as an alternative when it exists.</span>
    adminPrivateKey:
      path: artifacts/channel/crypto-config/peerOrganizations/org1.example.com/users/Admin@org1.example.com/msp/keystore/5890f0061619c06fb29dea8cb304edecc020fe63f41a6db109f1e227cc1cb2a8_sk
    signedCert:
      path: artifacts/channel/crypto-config/peerOrganizations/org1.example.com/users/Admin@org1.example.com/msp/signcerts/Admin@org1.example.com-cert.pem

  <span class="c"># the profile will contain public information about organizations other than the one it belongs to.</span>
  <span class="c"># These are necessary information to make transaction lifecycles work, including MSP IDs and</span>
  <span class="c"># peers with a public URL to send transaction proposals. The file will not contain private</span>
  <span class="c"># information reserved for members of the organization, such as admin key and certificate,</span>
  <span class="c"># fabric-ca registrar enroll ID and secret, etc.</span>
  Org2:
    mspid: Org2MSP
    peers:
      - peer0.org2.example.com
      - peer1.org2.example.com
    certificateAuthorities:
      - ca-org2
    adminPrivateKey:
      path: artifacts/channel/crypto-config/peerOrganizations/org2.example.com/users/Admin@org2.example.com/msp/keystore/1995b11d6573ed3be52fcd7a5fa477bc0f183e1f5f398c8281d0ce7c2c75a076_sk
    signedCert:
      path: artifacts/channel/crypto-config/peerOrganizations/org2.example.com/users/Admin@org2.example.com/msp/signcerts/Admin@org2.example.com-cert.pem

<span class="c">#</span>
<span class="c"># List of orderers to send transaction and channel create/update requests to. For the time</span>
<span class="c"># being only one orderer is needed. If more than one is defined, which one get used by the</span>
<span class="c"># SDK is implementation specific. Consult each SDK's documentation for its handling of orderers.</span>
<span class="c">#</span>
orderers:
  orderer.example.com:
    url: grpcs://192.168.99.100:7050

    <span class="c"># these are standard properties defined by the gRPC library</span>
    <span class="c"># they will be passed in as-is to gRPC client constructor</span>
    grpcOptions:
      ssl-target-name-override: orderer.example.com
      grpc-max-send-message-length: 15

    tlsCACerts:
      path: artifacts/channel/crypto-config/ordererOrganizations/example.com/orderers/orderer.example.com/tls/ca.crt

<span class="c">#</span>
<span class="c"># List of peers to send various requests to, including endorsement, query</span>
<span class="c"># and event listener registration.</span>
<span class="c">#</span>
peers:
  peer0.org1.example.com:
    <span class="c"># this URL is used to send endorsement and query requests</span>
    url: grpcs://192.168.99.100:7051

    <span class="c"># this URL is used to connect the EventHub and registering event listeners</span>
    eventUrl: grpcs://192.168.99.100:7053

    grpcOptions:
      ssl-target-name-override: peer0.org1.example.com
    tlsCACerts:
      path: artifacts/channel/crypto-config/peerOrganizations/org1.example.com/peers/peer0.org1.example.com/tls/ca.crt

  peer1.org1.example.com:
    url: grpcs://192.168.99.100:7056
    eventUrl: grpcs://192.168.99.100:7058
    grpcOptions:
      ssl-target-name-override: peer1.org1.example.com
    tlsCACerts:
      path: artifacts/channel/crypto-config/peerOrganizations/org1.example.com/peers/peer1.org1.example.com/tls/ca.crt

  peer0.org2.example.com:
    url: grpcs://192.168.99.100:8051
    eventUrl: grpcs://192.168.99.100:8053
    grpcOptions:
      ssl-target-name-override: peer0.org2.example.com
    tlsCACerts:
      path: artifacts/channel/crypto-config/peerOrganizations/org2.example.com/peers/peer0.org2.example.com/tls/ca.crt

  peer1.org2.example.com:
    url: grpcs://192.168.99.100:8056
    eventUrl: grpcs://192.168.99.100:8058
    grpcOptions:
      ssl-target-name-override: peer1.org2.example.com
    tlsCACerts:
      path: artifacts/channel/crypto-config/peerOrganizations/org2.example.com/peers/peer1.org2.example.com/tls/ca.crt

<span class="c">#</span>
<span class="c"># Fabric-CA is a special kind of Certificate Authority provided by Hyperledger Fabric which allows</span>
<span class="c"># certificate management to be done via REST APIs. Application may choose to use a standard</span>
<span class="c"># Certificate Authority instead of Fabric-CA, in which case this section would not be specified.</span>
<span class="c">#</span>
certificateAuthorities:
  ca-org1:
    url: https://192.168.99.100:7054
    <span class="c"># the properties specified under this object are passed to the 'http' client verbatim when</span>
    <span class="c"># making the request to the Fabric-CA server</span>
    httpOptions:
      verify: <span class="nb">false
    </span>tlsCACerts:
      path: artifacts/channel/crypto-config/peerOrganizations/org1.example.com/ca/ca.org1.example.com-cert.pem

    <span class="c"># Fabric-CA supports dynamic user enrollment via REST APIs. A "root" user, a.k.a registrar, is</span>
    <span class="c"># needed to enroll and invoke new users.</span>
    registrar:
      - enrollId: admin
        enrollSecret: adminpw
    <span class="c"># [Optional] The optional name of the CA.</span>
    caName: ca-org1

  ca-org2:
    url: https://192.168.99.100:8054
    httpOptions:
      verify: <span class="nb">false
    </span>tlsCACerts:
      path: artifacts/channel/crypto-config/peerOrganizations/org2.example.com/ca/ca.org2.example.com-cert.pem
    registrar:
      - enrollId: admin
        enrollSecret: adminpw
    <span class="c"># [Optional] The optional name of the CA.</span>
    caName: ca-org2
</code></pre></div></div>

<p>然后重新启动你的node服务。</p>

<h1 id="测试">测试</h1>

<p>注册和enroll新的user在org1</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl <span class="nt">-s</span> <span class="nt">-X</span> POST http://localhost:4000/users <span class="nt">-H</span> <span class="s2">"content-type: application/x-www-form-urlencoded"</span> <span class="nt">-d</span> <span class="s1">'username=Jim&amp;orgName=org1'</span>
</code></pre></div></div>

<p>输出</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">{</span>
  <span class="s2">"success"</span>: <span class="nb">true</span>,
  <span class="s2">"secret"</span>: <span class="s2">"RaxhMgevgJcm"</span>,
  <span class="s2">"message"</span>: <span class="s2">"Jim enrolled Successfully"</span>,
  <span class="s2">"token"</span>: <span class="s2">"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE0OTQ4NjU1OTEsInVzZXJuYW1lIjoiSmltIiwib3JnTmFtZSI6Im9yZzEiLCJpYXQiOjE0OTQ4NjE5OTF9.yWaJhFDuTvMQRaZIqg20Is5t-JJ_1BP58yrNLOKxtNI"</span>
<span class="o">}</span>
</code></pre></div></div>

<p>创建channel</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl <span class="nt">-s</span> <span class="nt">-X</span> POST <span class="se">\</span>
  http://localhost:4000/channels <span class="se">\</span>
  <span class="nt">-H</span> <span class="s2">"authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE0OTQ4NjU1OTEsInVzZXJuYW1lIjoiSmltIiwib3JnTmFtZSI6Im9yZzEiLCJpYXQiOjE0OTQ4NjE5OTF9.yWaJhFDuTvMQRaZIqg20Is5t-JJ_1BP58yrNLOKxtNI"</span> <span class="se">\</span>
  <span class="nt">-H</span> <span class="s2">"content-type: application/json"</span> <span class="se">\</span>
  <span class="nt">-d</span> <span class="s1">'{
	"channelName":"mychannel",
	"channelConfigPath":"../artifacts/channel/mychannel.tx"
}'</span>
</code></pre></div></div>

<p><strong>ps: authorization Bearer后跟之前的enroll的token</strong></p>

<p>org1加入channel</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl <span class="nt">-s</span> <span class="nt">-X</span> POST <span class="se">\</span>
  http://localhost:4000/channels/mychannel/peers <span class="se">\</span>
  <span class="nt">-H</span> <span class="s2">"authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE0OTQ4NjU1OTEsInVzZXJuYW1lIjoiSmltIiwib3JnTmFtZSI6Im9yZzEiLCJpYXQiOjE0OTQ4NjE5OTF9.yWaJhFDuTvMQRaZIqg20Is5t-JJ_1BP58yrNLOKxtNI"</span> <span class="se">\</span>
  <span class="nt">-H</span> <span class="s2">"content-type: application/json"</span> <span class="se">\</span>
  <span class="nt">-d</span> <span class="s1">'{
	"peers": ["peer1","peer2"]
}'</span>
</code></pre></div></div>

<p>安装链码</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl <span class="nt">-s</span> <span class="nt">-X</span> POST <span class="se">\</span>
  http://localhost:4000/chaincodes <span class="se">\</span>
  <span class="nt">-H</span> <span class="s2">"authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE0OTQ4NjU1OTEsInVzZXJuYW1lIjoiSmltIiwib3JnTmFtZSI6Im9yZzEiLCJpYXQiOjE0OTQ4NjE5OTF9.yWaJhFDuTvMQRaZIqg20Is5t-JJ_1BP58yrNLOKxtNI"</span> <span class="se">\</span>
  <span class="nt">-H</span> <span class="s2">"content-type: application/json"</span> <span class="se">\</span>
  <span class="nt">-d</span> <span class="s1">'{
	"peers": ["peer1","peer2"],
	"chaincodeName":"mycc",
	"chaincodePath":"github.com/example_cc",
	"chaincodeVersion":"v0"
}'</span>
</code></pre></div></div>

<p>初始化链码</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl <span class="nt">-s</span> <span class="nt">-X</span> POST <span class="se">\</span>
  http://localhost:4000/channels/mychannel/chaincodes <span class="se">\</span>
  <span class="nt">-H</span> <span class="s2">"authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE0OTQ4NjU1OTEsInVzZXJuYW1lIjoiSmltIiwib3JnTmFtZSI6Im9yZzEiLCJpYXQiOjE0OTQ4NjE5OTF9.yWaJhFDuTvMQRaZIqg20Is5t-JJ_1BP58yrNLOKxtNI"</span> <span class="se">\</span>
  <span class="nt">-H</span> <span class="s2">"content-type: application/json"</span> <span class="se">\</span>
  <span class="nt">-d</span> <span class="s1">'{
	"chaincodeName":"mycc",
	"chaincodeVersion":"v0",
	"args":["a","100","b","200"]
}'</span>
</code></pre></div></div>

<p>交易</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl <span class="nt">-s</span> <span class="nt">-X</span> POST <span class="se">\</span>
  http://localhost:4000/channels/mychannel/chaincodes/mycc <span class="se">\</span>
  <span class="nt">-H</span> <span class="s2">"authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE0OTQ4NjU1OTEsInVzZXJuYW1lIjoiSmltIiwib3JnTmFtZSI6Im9yZzEiLCJpYXQiOjE0OTQ4NjE5OTF9.yWaJhFDuTvMQRaZIqg20Is5t-JJ_1BP58yrNLOKxtNI"</span> <span class="se">\</span>
  <span class="nt">-H</span> <span class="s2">"content-type: application/json"</span> <span class="se">\</span>
  <span class="nt">-d</span> <span class="s1">'{
	"fcn":"move",
	"args":["a","b","10"]
}'</span>
</code></pre></div></div>

<p>查询</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl <span class="nt">-s</span> <span class="nt">-X</span> GET <span class="se">\</span>
  <span class="s2">"http://localhost:4000/channels/mychannel/chaincodes/mycc?peer=peer1&amp;fcn=query&amp;args=%5B%22a%22%5D"</span> <span class="se">\</span>
  <span class="nt">-H</span> <span class="s2">"authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE0OTQ4NjU1OTEsInVzZXJuYW1lIjoiSmltIiwib3JnTmFtZSI6Im9yZzEiLCJpYXQiOjE0OTQ4NjE5OTF9.yWaJhFDuTvMQRaZIqg20Is5t-JJ_1BP58yrNLOKxtNI"</span> <span class="se">\</span>
  <span class="nt">-H</span> <span class="s2">"content-type: application/json"</span>
</code></pre></div></div>

<p>根据区块号码查询</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl <span class="nt">-s</span> <span class="nt">-X</span> GET <span class="se">\</span>
  <span class="s2">"http://localhost:4000/channels/mychannel/blocks/1?peer=peer1"</span> <span class="se">\</span>
  <span class="nt">-H</span> <span class="s2">"authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE0OTQ4NjU1OTEsInVzZXJuYW1lIjoiSmltIiwib3JnTmFtZSI6Im9yZzEiLCJpYXQiOjE0OTQ4NjE5OTF9.yWaJhFDuTvMQRaZIqg20Is5t-JJ_1BP58yrNLOKxtNI"</span> <span class="se">\</span>
  <span class="nt">-H</span> <span class="s2">"content-type: application/json"</span>
</code></pre></div></div>

<p>根据transactionID查询交易</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl <span class="nt">-s</span> <span class="nt">-X</span> GET http://localhost:4000/channels/mychannel/transactions/TRX_ID?peer<span class="o">=</span>peer1 <span class="se">\</span>
  <span class="nt">-H</span> <span class="s2">"authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE0OTQ4NjU1OTEsInVzZXJuYW1lIjoiSmltIiwib3JnTmFtZSI6Im9yZzEiLCJpYXQiOjE0OTQ4NjE5OTF9.yWaJhFDuTvMQRaZIqg20Is5t-JJ_1BP58yrNLOKxtNI"</span> <span class="se">\</span>
  <span class="nt">-H</span> <span class="s2">"content-type: application/json"</span>
</code></pre></div></div>

<p><strong>ps：这里的后的字符为invoke返回的transactionID</strong></p>

<p>获取ChainInfo</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl <span class="nt">-s</span> <span class="nt">-X</span> GET <span class="se">\</span>
  <span class="s2">"http://localhost:4000/channels/mychannel?peer=peer1"</span> <span class="se">\</span>
  <span class="nt">-H</span> <span class="s2">"authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE0OTQ4NjU1OTEsInVzZXJuYW1lIjoiSmltIiwib3JnTmFtZSI6Im9yZzEiLCJpYXQiOjE0OTQ4NjE5OTF9.yWaJhFDuTvMQRaZIqg20Is5t-JJ_1BP58yrNLOKxtNI"</span> <span class="se">\</span>
  <span class="nt">-H</span> <span class="s2">"content-type: application/json"</span>
</code></pre></div></div>

<p>获取已安装的chaincode</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl <span class="nt">-s</span> <span class="nt">-X</span> GET <span class="se">\</span>
  <span class="s2">"http://localhost:4000/chaincodes?peer=peer1&amp;type=installed"</span> <span class="se">\</span>
  <span class="nt">-H</span> <span class="s2">"authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE0OTQ4NjU1OTEsInVzZXJuYW1lIjoiSmltIiwib3JnTmFtZSI6Im9yZzEiLCJpYXQiOjE0OTQ4NjE5OTF9.yWaJhFDuTvMQRaZIqg20Is5t-JJ_1BP58yrNLOKxtNI"</span> <span class="se">\</span>
  <span class="nt">-H</span> <span class="s2">"content-type: application/json"</span>
</code></pre></div></div>

<p>获取已实例化的chaincode</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl <span class="nt">-s</span> <span class="nt">-X</span> GET <span class="se">\</span>
  <span class="s2">"http://localhost:4000/chaincodes?peer=peer1&amp;type=instantiated"</span> <span class="se">\</span>
  <span class="nt">-H</span> <span class="s2">"authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE0OTQ4NjU1OTEsInVzZXJuYW1lIjoiSmltIiwib3JnTmFtZSI6Im9yZzEiLCJpYXQiOjE0OTQ4NjE5OTF9.yWaJhFDuTvMQRaZIqg20Is5t-JJ_1BP58yrNLOKxtNI"</span> <span class="se">\</span>
  <span class="nt">-H</span> <span class="s2">"content-type: application/json"</span>
</code></pre></div></div>

<p>获取channels</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl <span class="nt">-s</span> <span class="nt">-X</span> GET <span class="se">\</span>
  <span class="s2">"http://localhost:4000/channels?peer=peer1"</span> <span class="se">\</span>
  <span class="nt">-H</span> <span class="s2">"authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE0OTQ4NjU1OTEsInVzZXJuYW1lIjoiSmltIiwib3JnTmFtZSI6Im9yZzEiLCJpYXQiOjE0OTQ4NjE5OTF9.yWaJhFDuTvMQRaZIqg20Is5t-JJ_1BP58yrNLOKxtNI"</span> <span class="se">\</span>
  <span class="nt">-H</span> <span class="s2">"content-type: application/json"</span>
</code></pre></div></div>
</section>
   
   <!-- Tag list -->
  
  


<footer>
  <div class="tag-list">
    
      <div class="meta">Tags</div>
    

    
    <a class="button" href="/tags#fabric">
      <p><i class="fa fa-tag fa-fw"></i> fabric</p>
    </a>
    
    <a class="button" href="/tags#超级账本">
      <p><i class="fa fa-tag fa-fw"></i> 超级账本</p>
    </a>
    
  </div>
</footer>

    
</article>

<!-- Disqus -->


<!-- Post navigation -->

  <div id="post-nav">
  
  <div id="previous-post" class="post-nav-post">
      <p>Previous post</p>
      <a href="/2018/05/27/hyperledger-fabric-chaincode.html">
        fabric - chaincode(链码)
      </a>
  </div>
  
  
  <div id="next-post" class="post-nav-post">
      <p>Next post</p>
      <a href="/2018/05/27/hyperledger-fabric.html">
        fabric - 架构&执行流程
      </a>
  </div>
  
</div>

    </div>
    
<footer class="site-footer">
    <p class="text">Powered by <a href="https://jekyllrb.com/">Jekyll</a> with <a href="https://github.com/sylhare/Type-on-Strap">Type on Strap</a>
</p>
            <div class="footer-icons">
                <ul>
                <!-- Social icons from Font Awesome, if enabled -->
                
<li>
	<a href="http://localhost:4000/feed.xml" title="Follow RSS feed">
		<span class="fa-stack fa-lg">
            <i class="fa fa-circle fa-stack-2x"></i>
            <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
        </span>
	</a>
</li>















<li>
	<a href="https://github.com/shadowdragons" title="Follow on GitHub">
		<span class="fa-stack fa-lg">
            <i class="fa fa-circle fa-stack-2x"></i>
            <i class="fa fa-github fa-stack-1x fa-inverse"></i>
        </span>
	</a>
</li>
































                </ul>
            </div>
</footer>




  </body>
</html>
